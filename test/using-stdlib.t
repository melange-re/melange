  $ export MELANGELIB="$INSIDE_DUNE/lib/melange"

Set up a few directories we'll need

  $ mkdir -p app
  $ mkdir -p app/.objs/melange
  $ mkdir -p output/app

  $ cat > app/b.ml << EOF
  > let t = ["Hello"] |. Belt.List.map(fun greeting -> greeting)
  > EOF

Compile cmjs

  $ melc -bs-package-output app/ app/b.ml -nopervasives -bs-stop-after-cmj -o app/.objs/melange/b.cmj

Emit js

  $ melc -bs-module-type es6 -nopervasives -I app/.objs/melange/b.cmj -o output/app/b.js

Check b.js output

  $ cat output/app/b.js
  // Generated by Melange
  'use strict';

  var Belt_List = require("melange/lib/js/belt_List.js");

  var t = Belt_List.map(/* :: */[
        "Hello",
        /* [] */0
      ], (function (greeting) {
          return greeting;
        }));

  exports.t = t;
  /* No side effect */
