// Generated by Melange
'use strict';

const Caml_format = require("melange.js/caml_format.js");
const CamlinternalFormatBasics = require("melange/camlinternalFormatBasics.js");
const Curry = require("melange.js/curry.js");
const Mt = require("./mt.js");
const Stdlib = require("melange/stdlib.js");
const Stdlib__Format = require("melange/format.js");
const Stdlib__List = require("melange/list.js");
const Stdlib__Printf = require("melange/printf.js");
const Stdlib__Scanf = require("melange/scanf.js");

const suites = {
  contents: /* [] */ 0
};

const test_id = {
  contents: 0
};

function eq(loc, x, y) {
  test_id.contents = test_id.contents + 1 | 0;
  suites.contents = {
    hd: [
      loc + (" id " + String(test_id.contents)),
      (function (param) {
        return {
          TAG: /* Eq */ 0,
          _0: x,
          _1: y
        };
      })
    ],
    tl: suites.contents
  };
}

function eq3(loc, a, b, c) {
  eq(loc, a, b);
  eq(loc, b, c);
  eq(loc, a, c);
}

function $caret$caret(param, param$1) {
  return {
    TAG: /* Format */ 0,
    _0: CamlinternalFormatBasics.concat_fmt(param._0, param$1._0),
    _1: param._1 + ("%," + param$1._1)
  };
}

function u(param) {
  return $caret$caret({
        TAG: /* Format */ 0,
        _0: {
          TAG: /* String_literal */ 11,
          _0: "xx ",
          _1: {
            TAG: /* String */ 2,
            _0: /* No_padding */ 0,
            _1: /* End_of_format */ 0
          }
        },
        _1: "xx %s"
      }, {
        TAG: /* Format */ 0,
        _0: {
          TAG: /* String_literal */ 11,
          _0: "yy",
          _1: /* End_of_format */ 0
        },
        _1: "yy"
      });
}

const M = {};

eq("File \"jscomp/test/format_test.ml\", line 31, characters 5-12", Curry._1(Stdlib__Format.asprintf(u(undefined)), "x"), "xx xyy");

eq("File \"jscomp/test/format_test.ml\", line 32, characters 5-12", Curry._1(Stdlib__Format.asprintf({
            TAG: /* Format */ 0,
            _0: {
              TAG: /* Int32 */ 5,
              _0: /* Int_d */ 0,
              _1: /* No_padding */ 0,
              _2: /* No_precision */ 0,
              _3: /* End_of_format */ 0
            },
            _1: "%ld"
          }), -2147483648), "-2147483648");

eq("File \"jscomp/test/format_test.ml\", line 33, characters 5-12", Curry._1(Stdlib__Format.asprintf({
            TAG: /* Format */ 0,
            _0: {
              TAG: /* Int */ 4,
              _0: /* Int_d */ 0,
              _1: /* No_padding */ 0,
              _2: /* No_precision */ 0,
              _3: /* End_of_format */ 0
            },
            _1: "%d"
          }), -2147483648), "-2147483648");

eq("File \"jscomp/test/format_test.ml\", line 37, characters 5-12", 7.875, 7.875);

eq("File \"jscomp/test/format_test.ml\", line 40, characters 5-12", -7.875, -7.875);

eq3("File \"jscomp/test/format_test.ml\", line 44, characters 6-13", Infinity, Number.POSITIVE_INFINITY, Stdlib.infinity);

eq3("File \"jscomp/test/format_test.ml\", line 45, characters 6-13", -Infinity, Number.NEGATIVE_INFINITY, Stdlib.neg_infinity);

eq3("File \"jscomp/test/format_test.ml\", line 46, characters 6-13", Stdlib.max_float, 1.79769313486231571e+308, Number.MAX_VALUE);

eq("File \"jscomp/test/format_test.ml\", line 47, characters 5-12", Stdlib.classify_float(Infinity), /* FP_infinite */ 3);

eq("File \"jscomp/test/format_test.ml\", line 48, characters 5-12", Stdlib.classify_float(Infinity), /* FP_infinite */ 3);

eq("File \"jscomp/test/format_test.ml\", line 51, characters 5-12", Stdlib.min_float, 2.22507385850720138e-308);

eq("File \"jscomp/test/format_test.ml\", line 52, characters 5-12", Stdlib.epsilon_float, 2.22044604925031308e-16);

eq("File \"jscomp/test/format_test.ml\", line 53, characters 5-12", 4.94065645841e-324, 5e-324);

eq("File \"jscomp/test/format_test.ml\", line 54, characters 5-12", 1.00000000000000022 - 1, Stdlib.epsilon_float);

eq("File \"jscomp/test/format_test.ml\", line 56, characters 5-12", 1.11253692925360069e-308 / 2.22507385850720138e-308, 0.5);

eq("File \"jscomp/test/format_test.ml\", line 58, characters 5-12", Stdlib.classify_float(1.11253692925360069e-308), /* FP_subnormal */ 1);

eq("File \"jscomp/test/format_test.ml\", line 59, characters 5-12", 1.11253692925360069e-308, 1.11253692925360069e-308);

eq("File \"jscomp/test/format_test.ml\", line 61, characters 5-12", 2.22507385850720138e-308, 2.22507385850720138e-308);

eq("File \"jscomp/test/format_test.ml\", line 65, characters 5-12", (1 + 255 / 256) * 8, 15.96875);

eq("File \"jscomp/test/format_test.ml\", line 68, characters 5-12", (1 + 4095 / 4096) * 8, 15.998046875);

eq("File \"jscomp/test/format_test.ml\", line 71, characters 5-12", (1 + 65535 / 65536) * 8, 15.9998779296875);

function f(loc, ls) {
  Stdlib__List.iter((function (param) {
        eq(loc, Caml_format.caml_float_of_string(param[0]), param[1]);
      }), ls);
}

f("File \"jscomp/test/format_test.ml\", line 82, characters 6-13", {
      hd: [
        "0x3.fp+1",
        7.875
      ],
      tl: {
        hd: [
          " 0x3.fp2",
          15.75
        ],
        tl: {
          hd: [
            " 0x4.fp2",
            19.75
          ],
          tl: /* [] */ 0
        }
      }
    });

function sl(f) {
  return Curry._1(Stdlib__Printf.sprintf({
          TAG: /* Format */ 0,
          _0: {
            TAG: /* Float */ 8,
            _0: [
              /* Float_flag_ */ 0,
              /* Float_h */ 6
            ],
            _1: /* No_padding */ 0,
            _2: /* No_precision */ 0,
            _3: /* End_of_format */ 0
          },
          _1: "%h"
        }), f);
}

function aux_list(loc, ls) {
  Stdlib__List.iter((function (param) {
        eq(loc, sl(param[0]), param[1]);
      }), ls);
}

const literals_0 = [
  7.875,
  "0x1.f8p+2"
];

const literals_1 = {
  hd: [
    0.3,
    "0x1.3333333333333p-2"
  ],
  tl: {
    hd: [
      Stdlib.infinity,
      "infinity"
    ],
    tl: {
      hd: [
        0.4,
        "0x1.999999999999ap-2"
      ],
      tl: {
        hd: [
          0.5,
          "0x1p-1"
        ],
        tl: {
          hd: [
            0.6,
            "0x1.3333333333333p-1"
          ],
          tl: {
            hd: [
              0.7,
              "0x1.6666666666666p-1"
            ],
            tl: {
              hd: [
                0.8,
                "0x1.999999999999ap-1"
              ],
              tl: {
                hd: [
                  0.9,
                  "0x1.ccccccccccccdp-1"
                ],
                tl: /* [] */ 0
              }
            }
          }
        }
      }
    }
  }
};

const literals = {
  hd: literals_0,
  tl: literals_1
};

aux_list("File \"jscomp/test/format_test.ml\", line 112, characters 11-18", literals);

eq("File \"jscomp/test/format_test.ml\", line 115, characters 5-12", Curry._1(Stdlib__Printf.sprintf({
            TAG: /* Format */ 0,
            _0: {
              TAG: /* Float */ 8,
              _0: [
                /* Float_flag_ */ 0,
                /* Float_H */ 7
              ],
              _1: /* No_padding */ 0,
              _2: /* No_precision */ 0,
              _3: /* End_of_format */ 0
            },
            _1: "%H"
          }), 7.875), "0X1.F8P+2");

function scan_float(loc, s, expect) {
  Curry._1(Stdlib__Scanf.sscanf(s, {
          TAG: /* Format */ 0,
          _0: {
            TAG: /* Float */ 8,
            _0: [
              /* Float_flag_ */ 0,
              /* Float_h */ 6
            ],
            _1: /* No_padding */ 0,
            _2: /* No_precision */ 0,
            _3: /* End_of_format */ 0
          },
          _1: "%h"
        }), (function (result) {
      eq(loc, result, expect);
    }));
}

scan_float("File \"jscomp/test/format_test.ml\", line 120, characters 13-20", "0x3f.p1", 126);

scan_float("File \"jscomp/test/format_test.ml\", line 121, characters 13-20", "0x1.3333333333333p-2", 0.3);

Stdlib__List.iter((function (param) {
      scan_float("File \"jscomp/test/format_test.ml\", line 123, characters 13-20", param[1], param[0]);
    }), literals);

const f1 = - -9.9;

eq("File \"jscomp/test/format_test.ml\", line 129, characters 5-12", f1, 9.9);

Mt.from_pair_suites("Format_test", suites.contents);

module.exports = {
  suites,
  test_id,
  eq,
  eq3,
  $caret$caret,
  u,
  M,
  f,
  sl,
  aux_list,
  literals,
  scan_float,
}
/*  Not a pure module */
