// Generated by Melange
'use strict';

const Belt__Belt_HashMap = require("melange.belt/belt_HashMap.js");
const Belt__Belt_HashMapInt = require("melange.belt/belt_HashMapInt.js");
const Belt__Belt_HashMapString = require("melange.belt/belt_HashMapString.js");
const Belt__Belt_HashSetInt = require("melange.belt/belt_HashSetInt.js");
const Belt__Belt_Id = require("melange.belt/belt_Id.js");
const Belt__Belt_MapDict = require("melange.belt/belt_MapDict.js");
const Belt__Belt_internalBucketsType = require("melange.belt/belt_internalBucketsType.js");
const Caml = require("melange.js/caml.js");
const Caml_hash_primitive = require("melange.js/caml_hash_primitive.js");
const Caml_js_exceptions = require("melange.js/caml_js_exceptions.js");
const Stdlib__Hashtbl = require("melange/hashtbl.js");

function hash_string(s) {
  return Caml_hash_primitive.caml_hash_final_mix(Caml_hash_primitive.caml_hash_mix_string(0, s));
}

const hashString = (function(str){ 
                                              var hash = 5381,
                                              i    = str.length | 0;

                                              while(i !== 0) {
                                              hash = (hash * 33) ^ str.charCodeAt(--i);
                                              }
                                              return hash}
);

const $$String = Belt__Belt_Id.hashable(Stdlib__Hashtbl.hash, (function (x, y) {
        return x === y;
      }));

const String1 = Belt__Belt_Id.hashable(hashString, (function (x, y) {
        return x === y;
      }));

const String2 = Belt__Belt_Id.hashable((function (x) {
        return Caml_hash_primitive.caml_hash_final_mix(Caml_hash_primitive.caml_hash_mix_string(0, x));
      }), (function (x, y) {
        return x === y;
      }));

const Int = Belt__Belt_Id.hashable(Stdlib__Hashtbl.hash, (function (x, y) {
        return x === y;
      }));

const empty = Belt__Belt_internalBucketsType.make(Int.hash, Int.eq, 500000);

function bench(param) {
  for(let i = 0; i <= 1000000; ++i){
    Belt__Belt_HashMap.set(empty, i, i);
  }
  for(let i$1 = 0; i$1 <= 1000000; ++i$1){
    if (!Belt__Belt_HashMap.has(empty, i$1)) {
      throw new Caml_js_exceptions.MelangeError("Assert_failure", {
                MEL_EXN_ID: "Assert_failure",
                _1: [
                  "jscomp/test/bs_hashtbl_string_test.ml",
                  50,
                  4
                ]
              });
    }
    
  }
  Belt__Belt_HashMap.logStats(empty);
}

function bench2(m) {
  const empty = Belt__Belt_internalBucketsType.make(m.hash, m.eq, 1000000);
  for(let i = 0; i <= 1000000; ++i){
    Belt__Belt_HashMap.set(empty, String(i), i);
  }
  for(let i$1 = 0; i$1 <= 1000000; ++i$1){
    if (!Belt__Belt_HashMap.has(empty, String(i$1))) {
      throw new Caml_js_exceptions.MelangeError("Assert_failure", {
                MEL_EXN_ID: "Assert_failure",
                _1: [
                  "jscomp/test/bs_hashtbl_string_test.ml",
                  76,
                  4
                ]
              });
    }
    
  }
  for(let i$2 = 0; i$2 <= 1000000; ++i$2){
    Belt__Belt_HashMap.remove(empty, String(i$2));
  }
  if (empty.size === 0) {
    return ;
  }
  throw new Caml_js_exceptions.MelangeError("Assert_failure", {
            MEL_EXN_ID: "Assert_failure",
            _1: [
              "jscomp/test/bs_hashtbl_string_test.ml",
              82,
              2
            ]
          });
}

function bench3(m) {
  const empty_cmp = m.cmp;
  const cmp = m.cmp;
  let table = undefined;
  for(let i = 0; i <= 1000000; ++i){
    table = Belt__Belt_MapDict.set(table, String(i), i, cmp);
  }
  for(let i$1 = 0; i$1 <= 1000000; ++i$1){
    if (!Belt__Belt_MapDict.has(table, String(i$1), cmp)) {
      throw new Caml_js_exceptions.MelangeError("Assert_failure", {
                MEL_EXN_ID: "Assert_failure",
                _1: [
                  "jscomp/test/bs_hashtbl_string_test.ml",
                  98,
                  4
                ]
              });
    }
    
  }
  for(let i$2 = 0; i$2 <= 1000000; ++i$2){
    table = Belt__Belt_MapDict.remove(table, String(i$2), cmp);
  }
  if (Belt__Belt_MapDict.size(table) === 0) {
    return ;
  }
  throw new Caml_js_exceptions.MelangeError("Assert_failure", {
            MEL_EXN_ID: "Assert_failure",
            _1: [
              "jscomp/test/bs_hashtbl_string_test.ml",
              105,
              2
            ]
          });
}

const Sx = Belt__Belt_Id.comparable(Caml.caml_string_compare);

function bench4(param) {
  const table = Belt__Belt_internalBucketsType.make(undefined, undefined, 1000000);
  for(let i = 0; i <= 1000000; ++i){
    Belt__Belt_HashMapString.set(table, String(i), i);
  }
  for(let i$1 = 0; i$1 <= 1000000; ++i$1){
    if (!Belt__Belt_HashMapString.has(table, String(i$1))) {
      throw new Caml_js_exceptions.MelangeError("Assert_failure", {
                MEL_EXN_ID: "Assert_failure",
                _1: [
                  "jscomp/test/bs_hashtbl_string_test.ml",
                  118,
                  4
                ]
              });
    }
    
  }
  for(let i$2 = 0; i$2 <= 1000000; ++i$2){
    Belt__Belt_HashMapString.remove(table, String(i$2));
  }
  if (Belt__Belt_HashMapString.isEmpty(table)) {
    return ;
  }
  throw new Caml_js_exceptions.MelangeError("Assert_failure", {
            MEL_EXN_ID: "Assert_failure",
            _1: [
              "jscomp/test/bs_hashtbl_string_test.ml",
              124,
              2
            ]
          });
}

function bench5(param) {
  const table = Belt__Belt_internalBucketsType.make(Int.hash, Int.eq, 1000000);
  console.time("bs_hashtbl_string_test.ml 133");
  for(let i = 0; i <= 1000000; ++i){
    Belt__Belt_HashMap.set(table, i, i);
  }
  console.timeEnd("bs_hashtbl_string_test.ml 133");
  console.time("bs_hashtbl_string_test.ml 137");
  for(let i$1 = 0; i$1 <= 1000000; ++i$1){
    if (!Belt__Belt_HashMap.has(table, i$1)) {
      throw new Caml_js_exceptions.MelangeError("Assert_failure", {
                MEL_EXN_ID: "Assert_failure",
                _1: [
                  "jscomp/test/bs_hashtbl_string_test.ml",
                  138,
                  6
                ]
              });
    }
    
  }
  console.timeEnd("bs_hashtbl_string_test.ml 137");
  console.time("bs_hashtbl_string_test.ml 141");
  for(let i$2 = 0; i$2 <= 1000000; ++i$2){
    Belt__Belt_HashMap.remove(table, i$2);
  }
  console.timeEnd("bs_hashtbl_string_test.ml 141");
  if (Belt__Belt_HashMap.isEmpty(table)) {
    return ;
  }
  throw new Caml_js_exceptions.MelangeError("Assert_failure", {
            MEL_EXN_ID: "Assert_failure",
            _1: [
              "jscomp/test/bs_hashtbl_string_test.ml",
              144,
              2
            ]
          });
}

function bench6(param) {
  const table = Belt__Belt_internalBucketsType.make(undefined, undefined, 1000000);
  for(let i = 0; i <= 1000000; ++i){
    Belt__Belt_HashMapInt.set(table, i, i);
  }
  for(let i$1 = 0; i$1 <= 1000000; ++i$1){
    if (!Belt__Belt_HashMapInt.has(table, i$1)) {
      throw new Caml_js_exceptions.MelangeError("Assert_failure", {
                MEL_EXN_ID: "Assert_failure",
                _1: [
                  "jscomp/test/bs_hashtbl_string_test.ml",
                  156,
                  4
                ]
              });
    }
    
  }
  for(let i$2 = 0; i$2 <= 1000000; ++i$2){
    Belt__Belt_HashMapInt.remove(table, i$2);
  }
  if (table.size === 0) {
    return ;
  }
  throw new Caml_js_exceptions.MelangeError("Assert_failure", {
            MEL_EXN_ID: "Assert_failure",
            _1: [
              "jscomp/test/bs_hashtbl_string_test.ml",
              162,
              2
            ]
          });
}

function bench7(param) {
  const table = Belt__Belt_internalBucketsType.make(undefined, undefined, 2000000);
  for(let i = 0; i <= 1000000; ++i){
    Belt__Belt_HashSetInt.add(table, i);
  }
  for(let i$1 = 0; i$1 <= 1000000; ++i$1){
    if (!Belt__Belt_HashSetInt.has(table, i$1)) {
      throw new Caml_js_exceptions.MelangeError("Assert_failure", {
                MEL_EXN_ID: "Assert_failure",
                _1: [
                  "jscomp/test/bs_hashtbl_string_test.ml",
                  181,
                  4
                ]
              });
    }
    
  }
  for(let i$2 = 0; i$2 <= 1000000; ++i$2){
    Belt__Belt_HashSetInt.remove(table, i$2);
  }
  if (table.size === 0) {
    return ;
  }
  throw new Caml_js_exceptions.MelangeError("Assert_failure", {
            MEL_EXN_ID: "Assert_failure",
            _1: [
              "jscomp/test/bs_hashtbl_string_test.ml",
              192,
              2
            ]
          });
}

console.time("bs_hashtbl_string_test.ml 203");

bench7(undefined);

console.timeEnd("bs_hashtbl_string_test.ml 203");

const count = 1000000;

const initial_size = 1000000;

exports.hash_string = hash_string;
exports.hashString = hashString;
exports.$$String = $$String;
exports.String1 = String1;
exports.String2 = String2;
exports.Int = Int;
exports.empty = empty;
exports.bench = bench;
exports.count = count;
exports.initial_size = initial_size;
exports.bench2 = bench2;
exports.bench3 = bench3;
exports.Sx = Sx;
exports.bench4 = bench4;
exports.bench5 = bench5;
exports.bench6 = bench6;
exports.bench7 = bench7;
/* String Not a pure module */
