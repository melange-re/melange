// Generated by Melange
'use strict';

const Array_data_util = require("./array_data_util.js");
const Belt__Belt_Array = require("melange.belt/belt_Array.js");
const Belt__Belt_Id = require("melange.belt/belt_Id.js");
const Belt__Belt_List = require("melange.belt/belt_List.js");
const Belt__Belt_MutableSet = require("melange.belt/belt_MutableSet.js");
const Belt__Belt_internalAVLset = require("melange.belt/belt_internalAVLset.js");
const Caml = require("melange.js/caml.js");
const Mt = require("./mt.js");

const suites = {
  contents: /* [] */0
};

const test_id = {
  contents: 0
};

function eq(loc, x, y) {
  Mt.eq_suites(test_id, suites, loc, x, y);
}

function b(loc, x) {
  Mt.bool_suites(test_id, suites, loc, x);
}

const IntCmp = Belt__Belt_Id.comparable(Caml.caml_int_compare);

function fromArray(param) {
  return Belt__Belt_MutableSet.fromArray(param, IntCmp);
}

function empty(param) {
  return {
          cmp: IntCmp.cmp,
          data: undefined
        };
}

const u = fromArray(Array_data_util.range(0, 30));

b("File \"jscomp/test/bs_poly_mutable_set_test.ml\", line 18, characters 4-11", Belt__Belt_MutableSet.removeCheck(u, 0));

b("File \"jscomp/test/bs_poly_mutable_set_test.ml\", line 19, characters 4-11", !Belt__Belt_MutableSet.removeCheck(u, 0));

b("File \"jscomp/test/bs_poly_mutable_set_test.ml\", line 20, characters 4-11", Belt__Belt_MutableSet.removeCheck(u, 30));

b("File \"jscomp/test/bs_poly_mutable_set_test.ml\", line 21, characters 4-11", Belt__Belt_MutableSet.removeCheck(u, 20));

eq("File \"jscomp/test/bs_poly_mutable_set_test.ml\", line 22, characters 5-12", Belt__Belt_internalAVLset.size(u.data), 28);

const r = Array_data_util.randomRange(0, 30);

b("File \"jscomp/test/bs_poly_mutable_set_test.ml\", line 24, characters 4-11", 29 === Belt__Belt_internalAVLset.maxUndefined(u.data));

b("File \"jscomp/test/bs_poly_mutable_set_test.ml\", line 25, characters 4-11", 1 === Belt__Belt_internalAVLset.minUndefined(u.data));

Belt__Belt_MutableSet.add(u, 3);

for (let i = 0 ,i_finish = r.length; i < i_finish; ++i) {
  Belt__Belt_MutableSet.remove(u, r[i]);
}

b("File \"jscomp/test/bs_poly_mutable_set_test.ml\", line 30, characters 4-11", Belt__Belt_MutableSet.isEmpty(u));

Belt__Belt_MutableSet.add(u, 0);

Belt__Belt_MutableSet.add(u, 1);

Belt__Belt_MutableSet.add(u, 2);

Belt__Belt_MutableSet.add(u, 0);

eq("File \"jscomp/test/bs_poly_mutable_set_test.ml\", line 35, characters 5-12", Belt__Belt_internalAVLset.size(u.data), 3);

b("File \"jscomp/test/bs_poly_mutable_set_test.ml\", line 36, characters 4-11", !Belt__Belt_MutableSet.isEmpty(u));

for (let i$1 = 0; i$1 <= 3; ++i$1) {
  Belt__Belt_MutableSet.remove(u, i$1);
}

b("File \"jscomp/test/bs_poly_mutable_set_test.ml\", line 40, characters 4-11", Belt__Belt_MutableSet.isEmpty(u));

Belt__Belt_MutableSet.mergeMany(u, Array_data_util.randomRange(0, 20000));

Belt__Belt_MutableSet.mergeMany(u, Array_data_util.randomRange(0, 200));

eq("File \"jscomp/test/bs_poly_mutable_set_test.ml\", line 43, characters 5-12", Belt__Belt_internalAVLset.size(u.data), 20001);

Belt__Belt_MutableSet.removeMany(u, Array_data_util.randomRange(0, 200));

eq("File \"jscomp/test/bs_poly_mutable_set_test.ml\", line 45, characters 5-12", Belt__Belt_internalAVLset.size(u.data), 19800);

Belt__Belt_MutableSet.removeMany(u, Array_data_util.randomRange(0, 1000));

eq("File \"jscomp/test/bs_poly_mutable_set_test.ml\", line 47, characters 5-12", Belt__Belt_internalAVLset.size(u.data), 19000);

Belt__Belt_MutableSet.removeMany(u, Array_data_util.randomRange(0, 1000));

eq("File \"jscomp/test/bs_poly_mutable_set_test.ml\", line 49, characters 5-12", Belt__Belt_internalAVLset.size(u.data), 19000);

Belt__Belt_MutableSet.removeMany(u, Array_data_util.randomRange(1000, 10000));

eq("File \"jscomp/test/bs_poly_mutable_set_test.ml\", line 51, characters 5-12", Belt__Belt_internalAVLset.size(u.data), 10000);

Belt__Belt_MutableSet.removeMany(u, Array_data_util.randomRange(10000, 19999));

eq("File \"jscomp/test/bs_poly_mutable_set_test.ml\", line 53, characters 5-12", Belt__Belt_internalAVLset.size(u.data), 1);

b("File \"jscomp/test/bs_poly_mutable_set_test.ml\", line 54, characters 4-11", Belt__Belt_MutableSet.has(u, 20000));

Belt__Belt_MutableSet.removeMany(u, Array_data_util.randomRange(10000, 30000));

b("File \"jscomp/test/bs_poly_mutable_set_test.ml\", line 56, characters 4-11", Belt__Belt_MutableSet.isEmpty(u));

const v = fromArray(Array_data_util.randomRange(1000, 2000));

const bs = Belt__Belt_Array.map(Array_data_util.randomRange(500, 1499), (function (x) {
        return Belt__Belt_MutableSet.removeCheck(v, x);
      }));

const indeedRemoved = Belt__Belt_Array.reduce(bs, 0, (function (acc, x) {
        if (x) {
          return acc + 1 | 0;
        } else {
          return acc;
        }
      }));

eq("File \"jscomp/test/bs_poly_mutable_set_test.ml\", line 63, characters 5-12", indeedRemoved, 500);

eq("File \"jscomp/test/bs_poly_mutable_set_test.ml\", line 64, characters 5-12", Belt__Belt_internalAVLset.size(v.data), 501);

const cs = Belt__Belt_Array.map(Array_data_util.randomRange(500, 2000), (function (x) {
        return Belt__Belt_MutableSet.addCheck(v, x);
      }));

const indeedAded = Belt__Belt_Array.reduce(cs, 0, (function (acc, x) {
        if (x) {
          return acc + 1 | 0;
        } else {
          return acc;
        }
      }));

eq("File \"jscomp/test/bs_poly_mutable_set_test.ml\", line 67, characters 5-12", indeedAded, 1000);

eq("File \"jscomp/test/bs_poly_mutable_set_test.ml\", line 68, characters 5-12", Belt__Belt_internalAVLset.size(v.data), 1501);

b("File \"jscomp/test/bs_poly_mutable_set_test.ml\", line 69, characters 4-11", Belt__Belt_MutableSet.isEmpty({
          cmp: IntCmp.cmp,
          data: undefined
        }));

eq("File \"jscomp/test/bs_poly_mutable_set_test.ml\", line 70, characters 5-12", Belt__Belt_internalAVLset.minimum(v.data), 500);

eq("File \"jscomp/test/bs_poly_mutable_set_test.ml\", line 71, characters 5-12", Belt__Belt_internalAVLset.maximum(v.data), 2000);

eq("File \"jscomp/test/bs_poly_mutable_set_test.ml\", line 72, characters 5-12", Belt__Belt_internalAVLset.minUndefined(v.data), 500);

eq("File \"jscomp/test/bs_poly_mutable_set_test.ml\", line 73, characters 5-12", Belt__Belt_internalAVLset.maxUndefined(v.data), 2000);

eq("File \"jscomp/test/bs_poly_mutable_set_test.ml\", line 74, characters 5-12", Belt__Belt_MutableSet.reduce(v, 0, (function (x, y) {
            return x + y | 0;
          })), 1876250);

b("File \"jscomp/test/bs_poly_mutable_set_test.ml\", line 75, characters 4-11", Belt__Belt_List.eq(Belt__Belt_internalAVLset.toList(v.data), Belt__Belt_List.makeBy(1501, (function (i) {
                return i + 500 | 0;
              })), (function (x, y) {
            return x === y;
          })));

eq("File \"jscomp/test/bs_poly_mutable_set_test.ml\", line 76, characters 5-12", Belt__Belt_internalAVLset.toArray(v.data), Array_data_util.range(500, 2000));

Belt__Belt_internalAVLset.checkInvariantInternal(v.data);

eq("File \"jscomp/test/bs_poly_mutable_set_test.ml\", line 78, characters 5-12", Belt__Belt_MutableSet.get(v, 3), undefined);

eq("File \"jscomp/test/bs_poly_mutable_set_test.ml\", line 79, characters 5-12", Belt__Belt_MutableSet.get(v, 1200), 1200);

const match = Belt__Belt_MutableSet.split(v, 1000);

const match$1 = match[0];

const bb = match$1[1];

const aa = match$1[0];

b("File \"jscomp/test/bs_poly_mutable_set_test.ml\", line 81, characters 4-11", match[1]);

b("File \"jscomp/test/bs_poly_mutable_set_test.ml\", line 82, characters 4-11", Belt__Belt_Array.eq(Belt__Belt_internalAVLset.toArray(aa.data), Array_data_util.range(500, 999), (function (prim0, prim1) {
            return prim0 === prim1;
          })));

b("File \"jscomp/test/bs_poly_mutable_set_test.ml\", line 83, characters 4-11", Belt__Belt_Array.eq(Belt__Belt_internalAVLset.toArray(bb.data), Array_data_util.range(1001, 2000), (function (prim0, prim1) {
            return prim0 === prim1;
          })));

b("File \"jscomp/test/bs_poly_mutable_set_test.ml\", line 84, characters 5-12", Belt__Belt_MutableSet.subset(aa, v));

b("File \"jscomp/test/bs_poly_mutable_set_test.ml\", line 85, characters 4-11", Belt__Belt_MutableSet.subset(bb, v));

b("File \"jscomp/test/bs_poly_mutable_set_test.ml\", line 86, characters 4-11", Belt__Belt_MutableSet.isEmpty(Belt__Belt_MutableSet.intersect(aa, bb)));

const c = Belt__Belt_MutableSet.removeCheck(v, 1000);

b("File \"jscomp/test/bs_poly_mutable_set_test.ml\", line 88, characters 4-11", c);

const match$2 = Belt__Belt_MutableSet.split(v, 1000);

const match$3 = match$2[0];

const bb$1 = match$3[1];

const aa$1 = match$3[0];

b("File \"jscomp/test/bs_poly_mutable_set_test.ml\", line 90, characters 4-11", !match$2[1]);

b("File \"jscomp/test/bs_poly_mutable_set_test.ml\", line 91, characters 4-11", Belt__Belt_Array.eq(Belt__Belt_internalAVLset.toArray(aa$1.data), Array_data_util.range(500, 999), (function (prim0, prim1) {
            return prim0 === prim1;
          })));

b("File \"jscomp/test/bs_poly_mutable_set_test.ml\", line 92, characters 4-11", Belt__Belt_Array.eq(Belt__Belt_internalAVLset.toArray(bb$1.data), Array_data_util.range(1001, 2000), (function (prim0, prim1) {
            return prim0 === prim1;
          })));

b("File \"jscomp/test/bs_poly_mutable_set_test.ml\", line 93, characters 5-12", Belt__Belt_MutableSet.subset(aa$1, v));

b("File \"jscomp/test/bs_poly_mutable_set_test.ml\", line 94, characters 4-11", Belt__Belt_MutableSet.subset(bb$1, v));

b("File \"jscomp/test/bs_poly_mutable_set_test.ml\", line 95, characters 4-11", Belt__Belt_MutableSet.isEmpty(Belt__Belt_MutableSet.intersect(aa$1, bb$1)));

const aa$2 = fromArray(Array_data_util.randomRange(0, 100));

const bb$2 = fromArray(Array_data_util.randomRange(40, 120));

const cc = Belt__Belt_MutableSet.union(aa$2, bb$2);

b("File \"jscomp/test/bs_poly_mutable_set_test.ml\", line 104, characters 4-11", Belt__Belt_MutableSet.eq(cc, fromArray(Array_data_util.randomRange(0, 120))));

b("File \"jscomp/test/bs_poly_mutable_set_test.ml\", line 106, characters 4-11", Belt__Belt_MutableSet.eq(Belt__Belt_MutableSet.union(fromArray(Array_data_util.randomRange(0, 20)), fromArray(Array_data_util.randomRange(21, 40))), fromArray(Array_data_util.randomRange(0, 40))));

const dd = Belt__Belt_MutableSet.intersect(aa$2, bb$2);

b("File \"jscomp/test/bs_poly_mutable_set_test.ml\", line 111, characters 4-11", Belt__Belt_MutableSet.eq(dd, fromArray(Array_data_util.randomRange(40, 100))));

b("File \"jscomp/test/bs_poly_mutable_set_test.ml\", line 112, characters 4-11", Belt__Belt_MutableSet.eq(Belt__Belt_MutableSet.intersect(fromArray(Array_data_util.randomRange(0, 20)), fromArray(Array_data_util.randomRange(21, 40))), {
          cmp: IntCmp.cmp,
          data: undefined
        }));

b("File \"jscomp/test/bs_poly_mutable_set_test.ml\", line 118, characters 4-11", Belt__Belt_MutableSet.eq(Belt__Belt_MutableSet.intersect(fromArray(Array_data_util.randomRange(21, 40)), fromArray(Array_data_util.randomRange(0, 20))), {
          cmp: IntCmp.cmp,
          data: undefined
        }));

b("File \"jscomp/test/bs_poly_mutable_set_test.ml\", line 124, characters 4-11", Belt__Belt_MutableSet.eq(Belt__Belt_MutableSet.intersect(fromArray([
                  1,
                  3,
                  4,
                  5,
                  7,
                  9
                ]), fromArray([
                  2,
                  4,
                  5,
                  6,
                  8,
                  10
                ])), fromArray([
              4,
              5
            ])));

b("File \"jscomp/test/bs_poly_mutable_set_test.ml\", line 130, characters 4-11", Belt__Belt_MutableSet.eq(Belt__Belt_MutableSet.diff(aa$2, bb$2), fromArray(Array_data_util.randomRange(0, 39))));

b("File \"jscomp/test/bs_poly_mutable_set_test.ml\", line 132, characters 4-11", Belt__Belt_MutableSet.eq(Belt__Belt_MutableSet.diff(bb$2, aa$2), fromArray(Array_data_util.randomRange(101, 120))));

b("File \"jscomp/test/bs_poly_mutable_set_test.ml\", line 134, characters 4-11", Belt__Belt_MutableSet.eq(Belt__Belt_MutableSet.diff(fromArray(Array_data_util.randomRange(21, 40)), fromArray(Array_data_util.randomRange(0, 20))), fromArray(Array_data_util.randomRange(21, 40))));

b("File \"jscomp/test/bs_poly_mutable_set_test.ml\", line 140, characters 4-11", Belt__Belt_MutableSet.eq(Belt__Belt_MutableSet.diff(fromArray(Array_data_util.randomRange(0, 20)), fromArray(Array_data_util.randomRange(21, 40))), fromArray(Array_data_util.randomRange(0, 20))));

b("File \"jscomp/test/bs_poly_mutable_set_test.ml\", line 147, characters 4-11", Belt__Belt_MutableSet.eq(Belt__Belt_MutableSet.diff(fromArray(Array_data_util.randomRange(0, 20)), fromArray(Array_data_util.randomRange(0, 40))), fromArray(Array_data_util.randomRange(0, -1))));

const a0 = fromArray(Array_data_util.randomRange(0, 1000));

const a1 = Belt__Belt_MutableSet.keep(a0, (function (x) {
        return x % 2 === 0;
      }));

const a2 = Belt__Belt_MutableSet.keep(a0, (function (x) {
        return x % 2 !== 0;
      }));

const match$4 = Belt__Belt_MutableSet.partition(a0, (function (x) {
        return x % 2 === 0;
      }));

const a4 = match$4[1];

const a3 = match$4[0];

b("File \"jscomp/test/bs_poly_mutable_set_test.ml\", line 162, characters 4-11", Belt__Belt_MutableSet.eq(a1, a3));

b("File \"jscomp/test/bs_poly_mutable_set_test.ml\", line 163, characters 4-11", Belt__Belt_MutableSet.eq(a2, a4));

Belt__Belt_List.forEach({
      hd: a0,
      tl: {
        hd: a1,
        tl: {
          hd: a2,
          tl: {
            hd: a3,
            tl: {
              hd: a4,
              tl: /* [] */0
            }
          }
        }
      }
    }, (function (x) {
        Belt__Belt_internalAVLset.checkInvariantInternal(x.data);
      }));

Mt.from_pair_suites("Bs_poly_mutable_set_test", suites.contents);

const $plus$plus = Belt__Belt_MutableSet.union;

const f = fromArray;

const $eq$tilde = Belt__Belt_MutableSet.eq;

exports.suites = suites;
exports.test_id = test_id;
exports.eq = eq;
exports.b = b;
exports.IntCmp = IntCmp;
exports.fromArray = fromArray;
exports.empty = empty;
exports.$plus$plus = $plus$plus;
exports.f = f;
exports.$eq$tilde = $eq$tilde;
/* IntCmp Not a pure module */
