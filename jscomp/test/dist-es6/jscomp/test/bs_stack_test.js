// Generated by Melange

import * as Mt from "./mt.js";
import * as Caml_option from "melange/lib/es6/caml_option.mjs";
import * as Js_undefined from "melange.runtime-others/jscomp/others/js_undefined.js";
import * as Belt_MutableQueue from "melange.runtime-others/jscomp/others/belt_MutableQueue.js";
import * as Belt_MutableStack from "melange.runtime-others/jscomp/others/belt_MutableStack.js";

var suites = {
  contents: /* [] */0
};

var test_id = {
  contents: 0
};

function eq(loc, x, y) {
  Mt.eq_suites(test_id, suites, loc, x, y);
}

function inOrder(v) {
  var current = v;
  var s = {
    root: undefined
  };
  var q = {
    length: 0,
    first: undefined,
    last: undefined
  };
  while(current !== undefined) {
    var v$1 = current;
    Belt_MutableStack.push(s, v$1);
    current = v$1.left;
  };
  while(s.root !== undefined) {
    current = Belt_MutableStack.popUndefined(s);
    var v$2 = current;
    Belt_MutableQueue.add(q, v$2.value);
    current = v$2.right;
    while(current !== undefined) {
      var v$3 = current;
      Belt_MutableStack.push(s, v$3);
      current = v$3.left;
    };
  };
  return Belt_MutableQueue.toArray(q);
}

function inOrder3(v) {
  var current = v;
  var s = {
    root: undefined
  };
  var q = {
    length: 0,
    first: undefined,
    last: undefined
  };
  while(current !== undefined) {
    var v$1 = current;
    Belt_MutableStack.push(s, v$1);
    current = v$1.left;
  };
  Belt_MutableStack.dynamicPopIter(s, (function (popped) {
          Belt_MutableQueue.add(q, popped.value);
          var current = popped.right;
          while(current !== undefined) {
            var v = current;
            Belt_MutableStack.push(s, v);
            current = v.left;
          };
        }));
  return Belt_MutableQueue.toArray(q);
}

function inOrder2(v) {
  var todo = true;
  var cursor = v;
  var s = {
    root: undefined
  };
  var q = {
    length: 0,
    first: undefined,
    last: undefined
  };
  while(todo) {
    if (cursor !== undefined) {
      var v$1 = cursor;
      Belt_MutableStack.push(s, v$1);
      cursor = v$1.left;
    } else if (s.root !== undefined) {
      cursor = Belt_MutableStack.popUndefined(s);
      var current = cursor;
      Belt_MutableQueue.add(q, current.value);
      cursor = current.right;
    } else {
      todo = false;
    }
  };
}

function n(l, r, a) {
  return {
          value: a,
          left: Js_undefined.fromOption(l),
          right: Js_undefined.fromOption(r)
        };
}

var test1 = n(Caml_option.some(n(Caml_option.some(n(undefined, undefined, 4)), Caml_option.some(n(undefined, undefined, 5)), 2)), Caml_option.some(n(undefined, undefined, 3)), 1);

function pushAllLeft(st1, s1) {
  var current = st1;
  while(current !== undefined) {
    var v = current;
    Belt_MutableStack.push(s1, v);
    current = v.left;
  };
}

var test2 = n(Caml_option.some(n(Caml_option.some(n(Caml_option.some(n(Caml_option.some(n(undefined, undefined, 4)), undefined, 2)), undefined, 5)), undefined, 1)), undefined, 3);

var test3 = n(Caml_option.some(n(Caml_option.some(n(Caml_option.some(n(undefined, undefined, 4)), undefined, 2)), undefined, 5)), Caml_option.some(n(undefined, undefined, 3)), 1);

eq("File \"bs_stack_test.ml\", line 137, characters 6-13", inOrder(test1), [
      4,
      2,
      5,
      1,
      3
    ]);

eq("File \"bs_stack_test.ml\", line 140, characters 6-13", inOrder3(test1), [
      4,
      2,
      5,
      1,
      3
    ]);

Mt.from_pair_suites("bs_stack_test.ml", suites.contents);

export {
  suites ,
  test_id ,
  eq ,
  inOrder ,
  inOrder3 ,
  inOrder2 ,
  n ,
  test1 ,
  pushAllLeft ,
  test2 ,
  test3 ,
}
/* test1 Not a pure module */
