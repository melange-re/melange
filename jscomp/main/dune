(executable
 (public_name bsc)
 (modules bsc))

(executable
 (public_name melc)
 (modes byte_complete native)
 (flags :standard -open Melange_compiler_libs)
 (libraries
  js_parser
  bs_hash_stubs
  ext
  common
  outcome_printer
  melange-compiler-libs
  core
  napkin
  cmdliner
  reason)
 (modules melc melc_cli)
 (preprocessor_deps ../../package.json ../../bsconfig.json)
 (preprocess
  (action
   (run cppo %{env:CPPO_FLAGS=} %{input-file}))))

(executable
 (public_name bsb)
 (modes native)
 (modules bsb)
 (libraries bs_hash_stubs ext common bsb cmdliner))

(executable
 (public_name mel)
 (modes native)
 (modules mel mel_watcher)
 (libraries bs_hash_stubs ext common bsb cmdliner luv))

(executable
 (name cmjdump_main)
 (modes native)
 (modules cmjdump_main)
 (libraries bs_hash_stubs ext common core))

(executable
 (public_name meldep)
 (modes native)
 (modules meldep)
 (libraries bsb_helper ext common core cmdliner))

(test
 (name ounit_tests_main)
 (modes native)
 (modules ounit_tests_main)
 (deps
  melc.exe
  (alias ../runtime/all)
  (alias ../others/all)
  (alias ../stdlib-412/all))
 (libraries ounit2 bs_hash_stubs ext common bsb bsb_helper core ounit_tests))
